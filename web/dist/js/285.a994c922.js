"use strict";(self["webpackChunkvue2router"]=self["webpackChunkvue2router"]||[]).push([[285],{2804:function(e,t,s){s.d(t,{A:function(){return f}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"dialog",attrs:{id:"comment"+e.data.id},on:{click:function(t){return e.setChosenMargin(e.data.id)}}},[t("div",{staticClass:"info"},[t("span",[e._v("注释"+e._s(e.data.id+1))]),t("span",[e._v("位置"+e._s(e.data.position))]),t("margin-type",{attrs:{type:e.type},on:{displaySelectionPanel:function(t){return e.displaySelectionPanel()}}},[e._v(e._s(e.type))])],1),t("textarea",{attrs:{type:"text",disabled:"disabled"},domProps:{value:e.data.content}}),t("div",{staticClass:"buttons"},[t("button",{staticClass:"edit",on:{click:function(t){return e.edit(t,e.data.id)}}},[e._v("编辑")]),t("button",{staticClass:"delete",on:{click:function(t){return e.deleteComments(e.data.id)}}},[e._v("删除")]),t("a",{staticClass:"dialog-content",attrs:{href:this.link}},[e._v("跳转")])])])},n=[],a=function(){var e=this,t=e._self._c;return t("div",{ref:"tag",staticClass:"tag"},[t("span",[e._v(e._s(e.type))]),t("div",{staticClass:"answer"},[t("button",{style:"display:"+e.hidden,on:{click:e.addAnswer}},[e._v("查看/添加"+e._s(e.answer))])])])},l=[],o={props:{type:{type:String,required:!0},hide:{type:Boolean,required:!1,default:!0}},mounted(){console.log(this.type),"推测"===this.type?(this.$refs.tag.classList.add("inference"),this.answer="关联"):"疑点"===this.type?(this.$refs.tag.classList.add("question"),this.answer="解答"):"批注"===this.type&&(this.$refs.tag.classList.add("margin"),this.answer="关联")},data(){return{availableTypes:["推测","疑点","批注"],answer:"解答"}},methods:{addAnswer(){console.log("addAnswer"),this.$emit("displaySelectionPanel")}},computed:{hidden(){return"疑点"===this.type&&this.hide?"hidden":"none"}}},r=o,c=s(1656),m=(0,c.A)(r,a,l,!1,null,"6d5074f7",null),d=m.exports,h={props:{data:{type:Object,required:!0},type:{type:String},filename:{type:String}},components:{marginType:d},methods:{setChosenMargin(e){console.log("changed chosen margin"),this.$emit("setChosenMargin",e)},edit(e,t){e.currentTarget.parentNode.previousElementSibling.disabled=!e.currentTarget.parentNode.previousElementSibling.disabled,1==e.currentTarget.parentNode.previousElementSibling.disabled&&this.$emit("edit",t,e.currentTarget.parentNode.previousElementSibling.value)},deleteComments(e){this.$emit("deleteComments",e)},displaySelectionPanel(){console.log("display"),this.$emit("showSelectionModal")}},created(){""===this.filename||void 0===this.filename||null===this.filename?this.link=this.$route.path+"#dialog"+this.data.position:this.link="/search/"+this.filename+"#dialog"+this.data.position,console.log(this.link)},data(){return{link:""}}},p=h,u=(0,c.A)(p,i,n,!1,null,"7b32d8cd",null),f=u.exports},7285:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"comments"},[t("div",{staticClass:"condition"},[t("div",{staticClass:"condition-wrapper"},[t("span",[e._v("剧情名称")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.filename,expression:"filename"}],attrs:{type:"radio"},domProps:{value:e.filenames[0]},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.filename=t.target.multiple?s:s[0]}}},[t("option",{attrs:{value:"all"}},[e._v("all")]),e._l(e.filenames,(function(s,i){return t("option",{key:i},[e._v(e._s(s))])}))],2)]),t("div",{staticClass:"condition-wrapper"},[t("span",[e._v("查找内容")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchText,expression:"searchText"}],attrs:{type:"text"},domProps:{value:e.searchText},on:{input:function(t){t.target.composing||(e.searchText=t.target.value)}}})]),t("div",{staticClass:"condition-wrapper"},[t("span",[e._v("批注类型")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],attrs:{type:"radio"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.type=t.target.multiple?s:s[0]}}},[t("option",{attrs:{value:"all"}},[e._v("all")]),t("option",{attrs:{value:"疑点"}},[e._v("疑点")]),t("option",{attrs:{value:"推测"}},[e._v("推测")]),t("option",{attrs:{value:"批注"}},[e._v("批注")])])])]),t("br"),t("div",{staticClass:"comment-list"},[t("ul",[e._l(e.temp_comments,(function(s,i){return t("div",{key:i,ref:"margin",refInFor:!0,staticClass:"comment-wrapper",attrs:{id:"comment"+i},on:{click:function(t){return e.setChosenMargin(i,s.filename)}}},[t("span",[e._v(e._s(s.filename)+":")]),t("single-margin",{attrs:{data:s,type:s.type,filename:s.filename},on:{setChosenMargin:function(t){return e.setChosenMargin(i,s.filename)},edit:e.notAlter,deleteComments:e.notAlter}})],1)})),t("div",{staticStyle:{width:"100%",height:"400px"}})],2)]),t("div",{staticClass:"footer"},[t("button",{staticClass:"add",on:{click:e.add}},[e._v("添加")])])])},n=[],a=(s(3375),s(9225),s(3972),s(9209),s(5714),s(7561),s(6197),s(2804)),l=s(417),o={name:"BaseFriend",data(){return{type:"all",filename:"all",comments:[],filenames:[],temp_comments:[],chosen_margin:-1,chosen_filename:"",searchText:""}},components:{SingleMargin:a.A},async created(){const e=await(0,l.A)({url:"http://127.0.0.1:8000/get_all_comments"});this.comments=e.data,console.log(this.comments[0]),this.filenames=this.comments.map((e=>e.filename)),this.filenames=Array.from(new Set(this.filenames)),this.temp_comments=this.comments},methods:{add(){this.$emit("add",this.chosen_filename,this.temp_comments[this.chosen_margin].id)},notsupported(){console.log("not supported")},notAlter(){alert("you should not alter this")},setChosenMargin(e,t){console.log("this"),this.chosen_margin=e,this.chosen_filename=t},search(){"all"!=this.type&&(this.temp_comments=this.temp_comments.filter((e=>e.type===this.type)))},searchValidComments(){"all"!=this.filename?"all"!=this.type?this.temp_comments=this.comments.filter((e=>e.filename==this.filename&&e.type==this.type&&e.content.includes(this.searchText))):this.temp_comments=this.comments.filter((e=>e.filename==this.filename&&e.content.includes(this.searchText))):"all"!=this.type?this.temp_comments=this.comments.filter((e=>e.type==this.type&&e.content.includes(this.searchText))):this.temp_comments=this.comments.filter((e=>e.content.includes(this.searchText)))}},watch:{filename:{handler(){this.searchValidComments()}},type:{handler(){this.searchValidComments()}},searchText:{handler(){this.searchValidComments()}},chosen_margin(e,t){console.log(e),this.$refs.margin[e].classList.add("active-margin"),-1!=t&&this.$refs.margin[t].classList.remove("active-margin")}}},r=o,c=s(1656),m=(0,c.A)(r,i,n,!1,null,"525db3bf",null),d=m.exports}}]);
//# sourceMappingURL=285.a994c922.js.map